<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css">
    <style media="screen">
      nav{
        margin-bottom: 2%;
      }
    </style>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>

  <body>

    <!-- nav -->
    <nav class="green">
      <div class="nav-wrapper">
        <div class="container">
          <a href="#" class="brand-logo">Letter section</a>
          <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li><a href="collapsible.html">Date Home</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- nav -->

    <!-- content -->
    <div class="container">
      <!-- input letter -->
      <div class="row">
        <h5 class="green-text">INPUT LETTER : </h5>
        <div class="col s12">
          <div class="row">
            <div class="input-field col s5">
              <i class="material-icons prefix">textsms</i>
              <input id="letter_input" type="text" class="validate" max="1">
              <label for="icon_letter">Letter</label>
            </div>
            <div class="input-field col s5">
              <i class="material-icons prefix">trending_up</i>
              <input id="frequency_input" type="text" class="validate">
              <label for="icon_frequency">Frequency</label>
            </div>
            <div class="col s2">
              <a class="waves-effect green btn right" onclick="createLetter()">CREATE</a>
            </div>
          </div>
        </div>
      </div>
      <!-- input letter -->

      <!-- search -->
      <div class="row">
        <h5 class="green-text">SEARCH LETTER : </h5>
        <div class="col s12">
          <div class="row">
            <div class="input-field col s5">
              <i class="material-icons prefix">textsms</i>
              <input id="letter_search" type="text" class="validate" max="1">
              <label for="icon_letter">Letter</label>
            </div>
            <div class="input-field col s5">
              <i class="material-icons prefix">trending_up</i>
              <input id="frequency_search" type="text" class="validate">
              <label for="icon_frequency">Frequency</label>
            </div>
            <div class="col s2">
              <a class="waves-effect green btn right" onclick="searchLetter()">SEARCH</a>
            </div>
          </div>
        </div>
      </div>
      <!-- search -->

      <!-- letter list -->
      <div id="letter-table">
        <table>
          <thead>
            <tr>
                <th data-field="Letter" class="center">Letter</th>
                <th data-field="Frequency" class="center">Frequency</th>
                <th data-field="Action" class="center">Action</th>
            </tr>
          </thead>
          <tbody id="letter-list">
          </tbody>
        </table>
      </div>
      <!-- letter list -->
    </div>
    <!-- content -->

    <!--Import jQuery before materialize.js-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>
    <script type="text/javascript">

    $( document ).ready(function() {
        getAllLetter()
    });

    /* get all leter from databse */
    function getAllLetter(){
      $.ajax({
        url: "http://localhost:3000/api/letters",
        type: 'get',
        success: function( result ) {
          var temp = '';
          for (var i = 0; i < result.length; i++) {
            temp +=
            `
            <tr id="${result[i]._id}">
              <td class="center">${result[i].letter}</td>
              <td class="center">${result[i].frequency}</td>
              <td>
                <div class="center">
                  <a class="waves-effect green btn" onclick="editLetter('${result[i]._id}')">Edit</a>
                  <a class="waves-effect green btn" onclick="deleteLetter('${result[i]._id}')">Delete</a>
                </div>
              </td>
            </tr>
            `
          }

          $('#letter-list').prepend(temp)
        }
      });
    }

    /* create letter */
    function createLetter(){
      console.log('masuk');
      console.log($('#letter_input'));
      console.log($('#frequency_input'));
      $.ajax({
        url: "http://localhost:3000/api/letters",
        type: 'post',
        data: {
          letter: $('#letter_input').val(),
          frequency: $('#frequency_input').val()
        },
        success: function( result ) {
          console.log(result);
          let temp =
          `
          <tr id="${result._id}">
            <td class="center">${result.letter}</td>
            <td class="center">${result.frequency}</td>
            <td>
              <div class="center">
                <a class="waves-effect green btn" onclick="editLetter('${result._id}')">Edit</a>
                <a class="waves-effect green btn" onclick="deleteLetter('${result._id}')">Delete</a>
              </div>
            </td>
          </tr>
          `
          $('#letter-list').prepend(temp)
          // reset
          $('#letter_input').val(''),
          $('#frequency_input').val('')
        }
      });
    }

    // /* edit letter */
    // function editLetter(id){
    //   $.ajax({
    //     url: "/api/getWeather",
    //     type: 'put',
    //     data: {
    //       id: id,
    //       letter: '',
    //       frequency: ''
    //     },
    //     success: function( result ) {
    //       $( "#weather-temp" ).html( "<strong>" + result + "</strong> degrees" );
    //     }
    //   });
    // }
    //
    // /* delete letter */
    // function deleteLetter(id){
    //   $.ajax({
    //     url: "/api/getWeather",
    //     type: 'put',
    //     data: {
    //       id: '',
    //       letter: '',
    //       frequency: ''
    //     },
    //     success: function( result ) {
    //       $( "#weather-temp" ).html( "<strong>" + result + "</strong> degrees" );
    //     }
    //   });
    // }
    // /* search letter */
    // function searchLetter(){
    //   $.ajax({
    //     url: "/api/getWeather",
    //     type: 'put',
    //     data: {
    //       id: '',
    //       letter: '',
    //       frequency: ''
    //     },
    //     success: function( result ) {
    //       $( "#weather-temp" ).html( "<strong>" + result + "</strong> degrees" );
    //     }
    //   });
    // }



    </script>
  </body>
</html>
